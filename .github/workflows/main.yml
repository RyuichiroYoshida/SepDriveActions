name: Upload to GitHub Releases

on:
    workflow_dispatch: {}
permissions:
    contents: write
jobs:
    upload-release:
        runs-on: [self-hosted, Windows]
        env:
          DRIVE_PATH: H:\マイドライブ\September
        steps:
          - name: Create Zip
            shell: powershell
            run: |
              Write-Host "DRIVE_PATH from env: $env:DRIVE_PATH" # デバッグ用
              if ($env:DRIVE_PATH) {
                Compress-Archive -Force -Path "$env:DRIVE_PATH\Unity" -DestinationPath "$env:DRIVE_PATH\Unity.zip"
              } else {
                Write-Error "DRIVE_PATH environment variable is not set."
              }

          # GitHub Releasesへアップロード
          - name: Upload Releases
            if: failure() == false
            run: gh release create main "$env:DRIVE_PATH\Unity.zip" --title "Release main" --notes "This is a release created from a self-hosted runner." --target main
            env:
              GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
            # uses: ncipollo/release-action@v1
            # with:
            #   artifacts: file.zip
            #   token: ${{ secrets.GITHUB_TOKEN }}
            #   tag: ${{ github.ref_name }}
            #   name: Release ${{ github.ref_name }}
            #   body: |
            #     このリリースはセルフホストランナーからアップロードされました。
